{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/synseai/project/frontend/src/components/ProtectedRoute.tsx"],"sourcesContent":["\"use client\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\ninterface ProtectedRouteProps {\r\n  children: React.ReactNode;\r\n  allowedRoles: string[]; // e.g. [\"user\", \"employee\"]\r\n}\r\n\r\nexport default function ProtectedRoute({ children, allowedRoles }: ProtectedRouteProps) {\r\n  const router = useRouter();\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const token = sessionStorage.getItem(\"access_token\");\r\n    const role = sessionStorage.getItem(\"role\");\r\n\r\n    if (!token || !role) {\r\n      router.push(\"/login\");\r\n      return;\r\n    }\r\n\r\n    if (!allowedRoles.includes(role)) {\r\n      router.push(\"/\"); // redirect if role not allowed\r\n      return;\r\n    }\r\n\r\n    setLoading(false);\r\n  }, [router, allowedRoles]);\r\n\r\n  return <>{children}</>;\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AACA;AACA;;;AAFA;;;AASe,SAAS,eAAe,KAA+C;QAA/C,EAAE,QAAQ,EAAE,YAAY,EAAuB,GAA/C;;IACrC,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,MAAM,QAAQ,eAAe,OAAO,CAAC;YACrC,MAAM,OAAO,eAAe,OAAO,CAAC;YAEpC,IAAI,CAAC,SAAS,CAAC,MAAM;gBACnB,OAAO,IAAI,CAAC;gBACZ;YACF;YAEA,IAAI,CAAC,aAAa,QAAQ,CAAC,OAAO;gBAChC,OAAO,IAAI,CAAC,MAAM,+BAA+B;gBACjD;YACF;YAEA,WAAW;QACb;mCAAG;QAAC;QAAQ;KAAa;IAEzB,qBAAO;kBAAG;;AACZ;GAtBwB;;QACP,qIAAA,CAAA,YAAS;;;KADF","debugId":null}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/synseai/project/frontend/src/app/filespusher/page.tsx"],"sourcesContent":["\"use client\";\r\nimport Head from \"next/head\";\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\nimport ProtectedRoute from \"@/components/ProtectedRoute\";\r\nimport { FaArrowLeft, FaFileAlt, FaDownload, FaTimes, FaCheck, FaTimes as FaReject } from \"react-icons/fa\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport Image from \"next/image\";\r\nimport { Suspense } from \"react\";\r\n\r\ninterface Department {\r\n  id: number;\r\n  name: string;\r\n  isActive: boolean;\r\n  isCompleted: boolean;\r\n}\r\n\r\ninterface FileItem {\r\n  id: string;\r\n  name: string;\r\n  details: string;\r\n  dateCreated: string;\r\n  isSelected: boolean;\r\n  department: string;\r\n  downloadUrl?: string;\r\n  currentLocation?: number;\r\n  iteration?: number[];\r\n}\r\n\r\ninterface DocumentSetting {\r\n  id: number;\r\n  current_location: number;\r\n  iteration: number[];\r\n  updated_at: string;\r\n  document_id: number;\r\n  document_name: string;\r\n  document_created_at: string;\r\n  document_description: string;\r\n  download_url: string;\r\n}\r\n\r\nexport default function FilesPusher() {\r\n  return (\r\n    <Suspense fallback={<div>Loading...</div>}>\r\n      <FilesPusherContent />\r\n    </Suspense>\r\n  );\r\n}\r\n\r\nfunction FilesPusherContent() {\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const settingId = searchParams?.get(\"id\");\r\n  const API = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5000';\r\n\r\n  const [proposalTitle, setProposalTitle] = useState<string>(\"\");\r\n  const [proposalDetails, setProposalDetails] = useState<string>(\"\");\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  const [error, setError] = useState<string>(\"\");\r\n  const [documentSetting, setDocumentSetting] = useState<DocumentSetting | null>(null);\r\n  const [userDepartmentId, setUserDepartmentId] = useState<number | null>(null);\r\n  const [canInteract, setCanInteract] = useState<boolean>(false);\r\n  const [departments, setDepartments] = useState<Department[]>([]);\r\n  const [allDepartments, setAllDepartments] = useState<{ id: number, name: string }[]>([]);\r\n\r\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\r\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n  const [fileName, setFileName] = useState<string>('');\r\n  const [fileDescription, setFileDescription] = useState<string>('');\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const [isPushing, setIsPushing] = useState(false);\r\n  const [isApproving, setIsApproving] = useState(false);\r\n  const [isRejecting, setIsRejecting] = useState(false);\r\n\r\n  const [files, setFiles] = useState<FileItem[]>([]);\r\n\r\n  // Fetch all departments from database\r\n  const fetchDepartments = async () => {\r\n    try {\r\n      const token = sessionStorage.getItem('access_token');\r\n      if (!token) throw new Error(\"No token found.\");\r\n\r\n      const res = await fetch(`${API}/api/department`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n      });\r\n\r\n      if (!res.ok) {\r\n        throw new Error(`Failed to fetch departments: ${res.status}`);\r\n      }\r\n\r\n      const response = await res.json();\r\n      console.log(\"Fetched departments response:\", response);\r\n\r\n      // Extract departments array from the response\r\n      const departmentsData = response.departments || [];\r\n      setAllDepartments(departmentsData);\r\n      return departmentsData;\r\n    } catch (error) {\r\n      console.error(\"Error fetching departments:\", error);\r\n      throw error; // Re-throw to handle in calling function\r\n    }\r\n  };\r\n\r\n  // Enhanced function to get and refresh user's department ID\r\n  useEffect(() => {\r\n    const token = sessionStorage.getItem(\"access_token\");\r\n    const fetchUserDepartmentId = async () => {\r\n      if (!token) return;\r\n\r\n      try {\r\n        console.log(\"=== Fetching User Department from API ===\");\r\n        const res = await fetch(`${API}/api/user/me`, {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n        });\r\n\r\n        if (!res.ok) throw new Error(\"Failed to fetch user details\");\r\n\r\n        const data = await res.json();\r\n        console.log(\"✅ User data fetched:\", data);\r\n\r\n        // Extract department info\r\n        const deptId = data.department_id || data.user?.department_id;\r\n        const deptName = data.department_name || data.user?.department_name;\r\n\r\n        if (deptId) {\r\n          setUserDepartmentId(deptId);\r\n\r\n        } else {\r\n          console.warn(\"❌ Department ID missing in user data\");\r\n          setUserDepartmentId(null);\r\n\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error fetching user department:\", error);\r\n        setUserDepartmentId(null);\r\n\r\n      }\r\n    };\r\n\r\n    fetchUserDepartmentId();\r\n  }, [API]);\r\n\r\n\r\n\r\n  // Handle file selection from input or drag & drop\r\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files && e.target.files.length > 0) {\r\n      setSelectedFile(e.target.files[0]);\r\n    }\r\n  };\r\n\r\n  const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {\r\n    e.preventDefault();\r\n    if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\r\n      setSelectedFile(e.dataTransfer.files[0]);\r\n    }\r\n  };\r\n\r\n  // Update handler\r\n  const handleFileUpdate = async () => {\r\n    if (!selectedFile || !settingId) {\r\n      alert(\"Please select a file first.\");\r\n      return;\r\n    }\r\n\r\n    if (!canInteract) {\r\n      alert(\"You can only update documents that are currently at your department.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const token = sessionStorage.getItem(\"access_token\");\r\n      if (!token) throw new Error(\"No token found.\");\r\n\r\n      const formData = new FormData();\r\n      formData.append(\"file\", selectedFile);\r\n\r\n      const res = await fetch(`${API}/api/document_setting/update/${settingId}`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        body: formData,\r\n      });\r\n\r\n      const responseText = await res.text();\r\n      console.log(\"Update response:\", responseText);\r\n\r\n      if (!res.ok) {\r\n        throw new Error(`Update failed: ${responseText}`);\r\n      }\r\n\r\n      alert(\"File updated successfully!\");\r\n      setIsUploadModalOpen(false);\r\n      setSelectedFile(null);\r\n      setFileName(\"\");\r\n      setFileDescription(\"\");\r\n      window.location.reload();\r\n    } catch (err) {\r\n      if (err instanceof Error) {\r\n        console.error(err.message);\r\n        alert(`Error updating file: ${err.message}`);\r\n      } else {\r\n        console.error(err);\r\n        alert(\"Error updating file.\");\r\n      }\r\n    }\r\n  };\r\n\r\n  // Check if document is at the final department\r\n  const isAtFinalDepartment = () => {\r\n    if (!documentSetting) return false;\r\n    const currentIndex = documentSetting.iteration.indexOf(documentSetting.current_location);\r\n    return currentIndex >= documentSetting.iteration.length - 1;\r\n  };\r\n\r\n  // Push handler - moves document to next department in iteration\r\n  const handlePushDocument = async () => {\r\n    if (!settingId || !documentSetting) {\r\n      alert(\"No document setting found.\");\r\n      return;\r\n    }\r\n\r\n    if (!canInteract) {\r\n      alert(\"You can only push documents that are currently at your department.\");\r\n      return;\r\n    }\r\n\r\n    // Check if we're at the last department\r\n    if (isAtFinalDepartment()) {\r\n      alert(\"This document is already at the final department.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsPushing(true);\r\n      const token = sessionStorage.getItem(\"access_token\");\r\n      if (!token) throw new Error(\"No token found.\");\r\n\r\n      const res = await fetch(`${API}/api/document_setting/push/${settingId}`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorText = await res.text();\r\n        throw new Error(`Push failed: ${errorText}`);\r\n      }\r\n\r\n      const result = await res.json();\r\n      alert(\"Document pushed to next department successfully!\");\r\n\r\n      // Refresh the page to get updated data\r\n      window.location.reload();\r\n    } catch (err) {\r\n      console.error(\"Error pushing document:\", err);\r\n      alert(`Error pushing document: ${err instanceof Error ? err.message : 'Unknown error'}`);\r\n    } finally {\r\n      setIsPushing(false);\r\n    }\r\n  };\r\n\r\n  // Generic status update handler (similar to BpiDashboard pattern)\r\n  const handleStatusUpdate = async (newStatus: string, reason?: string) => {\r\n    if (!settingId || !documentSetting) {\r\n      alert(\"No document setting found.\");\r\n      return;\r\n    }\r\n\r\n    if (!canInteract) {\r\n      alert(\"You can only update documents that are currently at your department.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsApproving(newStatus === 'APPROVED');\r\n      setIsRejecting(newStatus === 'REJECTED');\r\n\r\n      const token = sessionStorage.getItem(\"access_token\");\r\n      if (!token) throw new Error(\"No token found.\");\r\n\r\n      // Update document status in database (following BpiDashboard pattern)\r\n      const res = await fetch(`${API}/api/document_setting/${settingId}/status`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          status: newStatus,\r\n          ...(reason && { rejection_reason: reason })\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json().catch(() => ({ error: \"Unknown error\" }));\r\n        throw new Error(errorData.error || `Failed to update document status`);\r\n      }\r\n\r\n      const result = await res.json();\r\n\r\n      // Update local state with new status\r\n      setDocumentSetting(prev => prev ? {\r\n        ...prev,\r\n        status: result.document_setting?.status || newStatus,\r\n        updated_at: new Date().toISOString()\r\n      } : null);\r\n\r\n      const statusLabel = newStatus === 'APPROVED' ? 'approved' :\r\n        newStatus === 'REJECTED' ? 'rejected' : 'updated';\r\n      alert(`Document ${statusLabel} successfully!`);\r\n\r\n      // Refresh the page to get updated data\r\n      window.location.reload();\r\n    } catch (err) {\r\n      console.error(`Error updating document status:`, err);\r\n      alert(`Error updating document status: ${err instanceof Error ? err.message : 'Unknown error'}`);\r\n    } finally {\r\n      setIsApproving(false);\r\n      setIsRejecting(false);\r\n    }\r\n  };\r\n\r\n  // Approve handler for final department\r\n  const handleApproveDocument = async () => {\r\n    if (!isAtFinalDepartment()) {\r\n      alert(\"You can only approve documents at the final department.\");\r\n      return;\r\n    }\r\n\r\n    await handleStatusUpdate('APPROVED');\r\n  };\r\n\r\n  // Reject handler for final department\r\n  const handleRejectDocument = async () => {\r\n    if (!isAtFinalDepartment()) {\r\n      alert(\"You can only reject documents at the final department.\");\r\n      return;\r\n    }\r\n\r\n    const reason = prompt(\"Please provide a reason for rejection (optional):\");\r\n    await handleStatusUpdate('REJECTED', reason || \"No reason provided\");\r\n  };\r\n\r\n  // Helper function to get department name by ID\r\n  const getDepartmentNameById = (deptId: number) => {\r\n    const dept = allDepartments.find(d => d.id === deptId);\r\n    return dept ? dept.name : `Department ${deptId}`;\r\n  };\r\n\r\n  // Update department status based on iteration and current location\r\n  const updateDepartmentStatus = (iteration: number[], currentLocation: number) => {\r\n    if (!allDepartments.length) return;\r\n\r\n    // Create departments array based on iteration order\r\n    const orderedDepartments: Department[] = iteration.map((deptId) => {\r\n      const deptInfo = allDepartments.find(d => d.id === deptId);\r\n      const currentIndex = iteration.indexOf(currentLocation);\r\n      const deptIndex = iteration.indexOf(deptId);\r\n\r\n      return {\r\n        id: deptId,\r\n        name: deptInfo ? deptInfo.name : `Department ${deptId}`,\r\n        isActive: deptId === currentLocation,\r\n        isCompleted: deptIndex < currentIndex\r\n      };\r\n    });\r\n\r\n    setDepartments(orderedDepartments);\r\n  };\r\n\r\n  // Refresh user access when document or user department changes\r\n  const refreshUserAccess = async () => {\r\n    console.log(\"Refreshing user access...\");\r\n\r\n    // Re-check interaction permissions\r\n    if (documentSetting && userDepartmentId !== null) {\r\n      const canUserInteract = documentSetting.current_location === userDepartmentId;\r\n      setCanInteract(canUserInteract);\r\n      console.log(\"Updated access:\", {\r\n        canInteract: canUserInteract,\r\n        currentLocation: documentSetting.current_location,\r\n        userDept: userDepartmentId\r\n      });\r\n    }\r\n  };\r\n\r\n  // Fetch document setting and files data\r\n  useEffect(() => {\r\n    if (!settingId) {\r\n      setError(\"No document setting ID provided\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    const fetchDocumentSettingAndFiles = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(\"\");\r\n\r\n        // First fetch departments\r\n        try {\r\n          await fetchDepartments();\r\n        } catch (deptError) {\r\n          console.error(\"Failed to fetch departments:\", deptError);\r\n          setError(\"Failed to load departments. Please try again.\");\r\n          return;\r\n        }\r\n\r\n        const token = sessionStorage.getItem('access_token');\r\n\r\n        if (!token) {\r\n          throw new Error(\"No authentication token found. Please log in again.\");\r\n        }\r\n\r\n        console.log(\"Attempting to fetch from:\", `${API}/api/document_setting/${settingId}`);\r\n\r\n        const res = await fetch(`${API}/api/document_setting/${settingId}`, {\r\n          method: 'GET',\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`,\r\n            'Content-Type': 'application/json',\r\n            'Accept': 'application/json',\r\n          },\r\n        });\r\n\r\n        console.log(\"Response status:\", res.status);\r\n\r\n        if (!res.ok) {\r\n          let errorMessage = `Failed to fetch document setting: ${res.status}`;\r\n          try {\r\n            const errorData = await res.json();\r\n            errorMessage = errorData.error || errorData.message || errorMessage;\r\n          } catch {\r\n            errorMessage = `HTTP ${res.status}: ${res.statusText}`;\r\n          }\r\n          throw new Error(errorMessage);\r\n        }\r\n\r\n        const documentSetting = await res.json();\r\n        console.log(\"Received document setting:\", documentSetting);\r\n        setDocumentSetting(documentSetting);\r\n\r\n        // Set title and details from the actual document data\r\n        setProposalTitle(documentSetting.document_name || `Document Setting ${settingId}`);\r\n        setProposalDetails(documentSetting.document_description || \"Push the files to the departments for review and approval\");\r\n\r\n        // Refresh user access after loading document\r\n        setTimeout(() => refreshUserAccess(), 100);\r\n\r\n      } catch (err) {\r\n        console.error(\"Error fetching document setting:\", err);\r\n        const errorMessage = err instanceof Error ? err.message : \"Failed to fetch document data\";\r\n        setError(errorMessage);\r\n\r\n        setProposalTitle(`Document Setting ${settingId}`);\r\n        setProposalDetails(\"Push the files to the departments for review and approval\");\r\n        setFiles([]);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchDocumentSettingAndFiles();\r\n  }, [settingId, API]);\r\n\r\n  // Update departments when we have both document setting and departments data\r\n  useEffect(() => {\r\n    if (documentSetting && allDepartments.length > 0) {\r\n      updateDepartmentStatus(documentSetting.iteration, documentSetting.current_location);\r\n\r\n      // Create file items for each department in iteration\r\n      const fileItems: FileItem[] = documentSetting.iteration.map((deptId, index) => {\r\n        const deptName = getDepartmentNameById(deptId);\r\n        const currentIndex = documentSetting.iteration.indexOf(documentSetting.current_location);\r\n\r\n        return {\r\n          id: `${documentSetting.document_id}-${deptId}`,\r\n          name: documentSetting.document_name,\r\n          details: documentSetting.document_description || \"Document file\",\r\n          dateCreated: documentSetting.document_created_at\r\n            ? new Date(documentSetting.document_created_at).toISOString().split('T')[0]\r\n            : new Date().toISOString().split('T')[0],\r\n          isSelected: false,\r\n          department: deptName,\r\n          downloadUrl: `${API}/api/document/download_file/${documentSetting.document_id}`,\r\n          currentLocation: documentSetting.current_location,\r\n          iteration: documentSetting.iteration\r\n        };\r\n      });\r\n\r\n      setFiles(fileItems);\r\n    }\r\n  }, [documentSetting, allDepartments]);\r\n\r\n  // Check if user can interact with document (update/push/approve/reject)\r\n  useEffect(() => {\r\n    if (documentSetting && userDepartmentId !== null) {\r\n      const canUserInteract = documentSetting.current_location === userDepartmentId;\r\n      setCanInteract(canUserInteract);\r\n      console.log(\"Can user interact:\", canUserInteract, \"Current location:\", documentSetting.current_location, \"User dept:\", userDepartmentId);\r\n    }\r\n  }, [documentSetting, userDepartmentId]);\r\n\r\n  const handleFileSelect = (file: FileItem) => {\r\n    setFiles((prev) =>\r\n      prev.map((f) => (f.id === file.id ? { ...f, isSelected: !f.isSelected } : f))\r\n    );\r\n  };\r\n\r\n  // Download function\r\n  const handleDownload = (file: FileItem) => {\r\n    if (!file.downloadUrl) {\r\n      alert(\"No download URL available for this file\");\r\n      return;\r\n    }\r\n\r\n    console.log(\"Opening download URL:\", file.downloadUrl);\r\n    window.open(file.downloadUrl, \"_blank\");\r\n  };\r\n\r\n  // Get file card image based on department status\r\n  const getFileCardImage = (file: FileItem) => {\r\n    if (!documentSetting) return \"/images/file-card.png\";\r\n\r\n    const currentIndex = documentSetting.iteration.indexOf(documentSetting.current_location);\r\n    const fileDeptIndex = documentSetting.iteration.findIndex(deptId =>\r\n      getDepartmentNameById(deptId) === file.department\r\n    );\r\n\r\n    // If this department has been completed (file passed through)\r\n    if (fileDeptIndex < currentIndex) {\r\n      return \"/images/file-card-black.png\";\r\n    }\r\n\r\n    // If this is the current department\r\n    if (fileDeptIndex === currentIndex) {\r\n      return \"/images/file-card.png\";\r\n    }\r\n\r\n    // If this department hasn't been reached yet\r\n    return \"/images/file-card.png\";\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <ProtectedRoute allowedRoles={[\"user\", \"employee\", \"admin\"]}>\r\n        <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#B11016] mx-auto mb-4\"></div>\r\n            <p className=\"text-gray-600\">Loading document...</p>\r\n          </div>\r\n        </div>\r\n      </ProtectedRoute>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <ProtectedRoute allowedRoles={[\"user\", \"employee\", \"admin\"]}>\r\n      <div className=\"min-h-screen bg-gray-50 flex flex-col items-center px-4 sm:px-[5%] lg:px-[10%] py-4 sm:py-8\">\r\n        {/* Header */}\r\n        <div className=\"relative flex items-center w-full mt-2 mb-4\">\r\n          <button\r\n            onClick={() => router.back()}\r\n            className=\"absolute left-0 flex items-center text-[#B11016] hover:text-[#800b10] text-sm sm:text-base\"\r\n          >\r\n            <FaArrowLeft className=\"mr-2\" />\r\n            <span className=\"hidden sm:inline\">Back</span>\r\n          </button>\r\n\r\n          <div className=\"text-center w-full\">\r\n            <h1 className=\"text-xl sm:text-2xl lg:text-4xl font-bold text-[#B11016] pb-2 sm:pb-4\">\r\n              Files Pusher\r\n            </h1>\r\n            <p className=\"text-sm sm:text-md text-black mb-4 sm:mb-6 px-4\">\r\n              Push the files to the departments for review and approval.\r\n            </p>\r\n            <div className=\"mx-2 border-b-[3px] border-[#B11016]\"></div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Error Display */}\r\n        {error && (\r\n          <div className=\"w-full max-w-6xl mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded\">\r\n            <p className=\"text-sm\">{error}</p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Access Control Notice */}\r\n        {userDepartmentId === null && (\r\n          <div className=\"w-full max-w-6xl mb-4 p-4 bg-blue-100 border border-blue-400 text-blue-700 rounded\">\r\n            <p className=\"text-sm\">\r\n              <strong>Note:</strong> Department information not found.\r\n              <button\r\n                onClick={refreshUserAccess}\r\n                className=\"ml-2 px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700\"\r\n              >\r\n                Refresh Access\r\n              </button>\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {!canInteract && documentSetting && userDepartmentId !== null && (\r\n          <div className=\"w-full max-w-6xl mb-4 p-4 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded\">\r\n            <p className=\"text-sm\">\r\n              This document is currently at {getDepartmentNameById(documentSetting.current_location)}.\r\n              You can only interact with documents that are at your department (Department ID: {userDepartmentId}).\r\n              <button\r\n                onClick={refreshUserAccess}\r\n                className=\"ml-2 px-2 py-1 bg-yellow-600 text-white text-xs rounded hover:bg-yellow-700\"\r\n              >\r\n                Refresh Access\r\n              </button>\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* File Info Headers */}\r\n        <div className=\"w-full max-w-6xl mt-2 grid grid-cols-3 gap-4 text-lg font-semibold text-gray-800\">\r\n          <div><span className=\"text-[#B11016] font-bold\">File Name:</span> {proposalTitle}</div>\r\n          <div><span className=\"text-[#B11016] font-bold\">File Description:</span>  {proposalDetails}</div>\r\n          <div>\r\n            <span className=\"text-[#B11016] font-bold\">Date created:</span>{\" \"}\r\n            {files.length > 0 ? files[0].dateCreated : \"N/A\"}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Department Navigation with File Cards Below */}\r\n        <div className=\"w-full max-w-6xl mt-6 mb-8\">\r\n          {/* Department Progress Indicator */}\r\n          <div className=\"flex space-x-2 w-full mb-6\">\r\n            {departments.map((dept) => (\r\n              <div\r\n                key={dept.id}\r\n                className={`flex-1 h-10 rounded flex items-center justify-center text-xs font-medium transition-colors duration-300 ${dept.isCompleted\r\n                  ? \"bg-[#333333] text-white\"\r\n                  : dept.isActive\r\n                    ? \"bg-[#B11016] text-white\"\r\n                    : \"bg-gray-300 text-gray-700\"\r\n                  }`}\r\n              >\r\n                <span className=\"text-center px-1 truncate\" title={dept.name}>\r\n                  {dept.name}\r\n                </span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* File Cards positioned below each department column */}\r\n          <div className=\"flex space-x-2 w-full\">\r\n            {departments.map((dept) => {\r\n              const deptFile = files.find(file => file.department === dept.name);\r\n\r\n              return (\r\n                <div key={dept.id} className=\"flex-1 flex flex-col items-center\">\r\n                  {deptFile ? (\r\n                    <div className=\"text-center\">\r\n                      <div\r\n                        className={`cursor-pointer transition-all duration-200 ${deptFile.isSelected ? \"transform scale-105\" : \"\"\r\n                          }`}\r\n                        onClick={() => handleFileSelect(deptFile)}\r\n                      >\r\n                        <div className=\"relative mb-4\">\r\n                          <Image\r\n                            src={deptFile.isSelected ? \"/images/file-card-black.png\" : getFileCardImage(deptFile)}\r\n                            alt=\"File Card\"\r\n                            width={120}\r\n                            height={144}\r\n                            className=\"mx-auto\"\r\n                          />\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"text-xs font-medium text-gray-800 mb-2 truncate px-1\" title={deptFile.name}>\r\n                        {deptFile.name}\r\n                      </div>\r\n\r\n                      {/* Download Button */}\r\n                      <button\r\n                        onClick={() => handleDownload(deptFile)}\r\n                        className=\"px-3 py-1 bg-[#B11016] text-white text-xs rounded hover:bg-[#800b10] transition-colors flex items-center justify-center mx-auto\"\r\n                        disabled={!deptFile.downloadUrl}\r\n                      >\r\n                        <FaDownload className=\"mr-1\" size={10} />\r\n                        Download\r\n                      </button>\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"text-center py-8 text-gray-400\">\r\n                      <FaFileAlt className=\"mx-auto text-2xl mb-2 opacity-30\" />\r\n                      <p className=\"text-xs\">\r\n                        No file\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n\r\n          {/* Show message if no files at all */}\r\n          {files.length === 0 && (\r\n            <div className=\"text-center py-12 text-gray-500\">\r\n              <FaFileAlt className=\"mx-auto text-4xl mb-4 opacity-30\" />\r\n              <p className=\"text-sm sm:text-base\">\r\n                No document available\r\n              </p>\r\n              <p className=\"text-xs text-gray-400 mt-2\">\r\n                Document will appear here when loaded\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"w-full max-w-6xl mb-8\">\r\n          <div className=\"flex justify-center space-x-4\">\r\n            <button\r\n              onClick={() => setIsUploadModalOpen(true)}\r\n              disabled={!canInteract || userDepartmentId === null}\r\n              className={`${isAtFinalDepartment() ? 'w-full max-w-xs' : 'w-full max-w-xs'} px-6 py-3 rounded transition-colors ${canInteract && userDepartmentId !== null\r\n                ? \"bg-[#333333] text-white hover:bg-[#0f0f0f]\"\r\n                : \"bg-gray-400 text-gray-600 cursor-not-allowed\"\r\n                }`}\r\n            >\r\n              Update\r\n            </button>\r\n\r\n            {/* Show Push button if not at final department */}\r\n            {!isAtFinalDepartment() && (\r\n              <button\r\n                onClick={handlePushDocument}\r\n                disabled={!canInteract || isPushing || userDepartmentId === null}\r\n                className={`w-full max-w-xs px-6 py-3 rounded transition-colors ${canInteract && !isPushing && userDepartmentId !== null\r\n                  ? \"bg-[#B11016] text-white hover:bg-[#800b10]\"\r\n                  : \"bg-gray-400 text-gray-600 cursor-not-allowed\"\r\n                  }`}\r\n              >\r\n                {isPushing ? \"Pushing...\" : \"Push\"}\r\n              </button>\r\n            )}\r\n\r\n            {/* Show Approve/Reject buttons if at final department */}\r\n            {isAtFinalDepartment() && (\r\n              <>\r\n                <button\r\n                  onClick={handleApproveDocument}\r\n                  disabled={!canInteract || isApproving || userDepartmentId === null}\r\n                  className={`w-full max-w-xs px-6 py-3 rounded transition-colors flex items-center justify-center ${canInteract && !isApproving && userDepartmentId !== null\r\n                    ? \"bg-green-600 text-white hover:bg-green-700\"\r\n                    : \"bg-gray-400 text-gray-600 cursor-not-allowed\"\r\n                    }`}\r\n                >\r\n                  <FaCheck className=\"mr-2\" />\r\n                  {isApproving ? \"Approving...\" : \"Approve\"}\r\n                </button>\r\n\r\n                <button\r\n                  onClick={handleRejectDocument}\r\n                  disabled={!canInteract || isRejecting || userDepartmentId === null}\r\n                  className={`w-full max-w-xs px-6 py-3 rounded transition-colors flex items-center justify-center ${canInteract && !isRejecting && userDepartmentId !== null\r\n                    ? \"bg-red-600 text-white hover:bg-red-700\"\r\n                    : \"bg-gray-400 text-gray-600 cursor-not-allowed\"\r\n                    }`}\r\n                >\r\n                  <FaReject className=\"mr-2\" />\r\n                  {isRejecting ? \"Rejecting...\" : \"Reject\"}\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n\r\n          {/* Help text */}\r\n          <div className=\"text-center text-sm text-gray-500 mt-2 space-y-1\">\r\n            {userDepartmentId === null ? (\r\n              <p>Department information not available. Please check your login setup or refresh access.</p>\r\n            ) : !canInteract ? (\r\n              <p>You can only interact with documents that are currently at your department.</p>\r\n            ) : isAtFinalDepartment() ? (\r\n              <p>Document has reached the final department. You can update, approve, or reject the document.</p>\r\n            ) : (\r\n              <p>You can update the document or push it to the next department.</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Upload Modal with Drag & Drop */}\r\n        {isUploadModalOpen && (\r\n          <div className=\"fixed inset-0 flex items-center justify-center bg-black/50 z-50\">\r\n            <div className=\"bg-white rounded-lg shadow-lg w-full max-w-lg p-6 relative mx-4\">\r\n              {/* Close button */}\r\n              <button\r\n                onClick={() => {\r\n                  setIsUploadModalOpen(false);\r\n                  setSelectedFile(null);\r\n                  setFileName('');\r\n                  setFileDescription('');\r\n                }}\r\n                className=\"absolute top-3 right-3 text-gray-500 hover:text-gray-700\"\r\n              >\r\n                <FaTimes />\r\n              </button>\r\n\r\n              <h2 className=\"text-xl font-semibold text-[#B11016] mb-4\">\r\n                Update File\r\n              </h2>\r\n\r\n              {/* Drag and Drop Area */}\r\n              <div\r\n                onDrop={handleDrop}\r\n                onDragOver={(e) => e.preventDefault()}\r\n                className=\"border-2 border-dashed border-red-300 rounded-lg p-6 text-center cursor-pointer hover:border-red-500 transition mb-4\"\r\n                onClick={() => fileInputRef.current?.click()}\r\n              >\r\n                <img\r\n                  src=\"/images/uploadicon.png\"\r\n                  alt=\"Upload Icon\"\r\n                  className=\"mx-auto h-12 w-12 object-contain\"\r\n                />\r\n\r\n                <p className=\"mt-2 text-gray-600 text-sm\">\r\n                  Drag & drop files or{\" \"}\r\n                  <span className=\"text-red-600 underline\">Browse</span>\r\n                </p>\r\n                <p className=\"text-xs text-gray-400\">\r\n                  Supported formats: JPEG, PNG, PDF, DOCX\r\n                </p>\r\n\r\n                <input\r\n                  type=\"file\"\r\n                  accept=\".jpeg,.jpg,.png,.pdf,.docx\"\r\n                  ref={fileInputRef}\r\n                  className=\"hidden\"\r\n                  onChange={handleFileChange}\r\n                />\r\n              </div>\r\n\r\n              {/* Selected File Display */}\r\n              {selectedFile && (\r\n                <div className=\"mb-4 p-2 border border-green-400 rounded bg-green-50 text-green-700 text-sm\">\r\n                  Selected: {selectedFile.name}\r\n                </div>\r\n              )}\r\n\r\n              {/* Update Button */}\r\n              <button\r\n                onClick={handleFileUpdate}\r\n                disabled={!selectedFile}\r\n                className=\"w-full px-4 py-2 bg-[#B11016] text-white rounded hover:bg-[#800b10] transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed\"\r\n              >\r\n                Update File\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </ProtectedRoute>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}