{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/synseai/project/frontend/src/app/bpifindcollabcompany/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState, Suspense } from \"react\";\r\nimport { useSearchParams, useRouter } from \"next/navigation\";\r\nimport { FaArrowLeft } from \"react-icons/fa\";\r\n\r\nexport default function BpiFindCollabCompany() {\r\n  return (\r\n    <Suspense fallback={<div>Loading...</div>}>\r\n      <BpiFindCollabCompanyContent />\r\n    </Suspense>\r\n  );\r\n}\r\n\r\nfunction BpiFindCollabCompanyContent() {\r\n  const API = process.env.NEXT_PUBLIC_API_URL;\r\n  const searchParams = useSearchParams();\r\n  const router = useRouter();\r\n  const company = searchParams.get(\"company\");\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [scoring, setScoring] = useState<{\r\n    credibility_score: number;\r\n    referential_score: number;\r\n    compliance_score: number;\r\n    credibility_reasoning?: string;\r\n    referential_reasoning?: string;\r\n    compliance_reasoning?: string;\r\n  } | null>(null);\r\n\r\n  const [projects, setProjects] = useState<\r\n    { title: string; description: string }[]\r\n  >([]);\r\n\r\n  useEffect(() => {\r\n    const fetchCompanyData = async () => {\r\n      if (!company) return;\r\n\r\n      const token = sessionStorage.getItem(\"access_token\");\r\n      if (!token) {\r\n        setError(\"Unauthorized. Please log in again.\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        setLoading(true);\r\n        const res = await fetch(`${API}/api/find_company/name`, {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n          body: JSON.stringify({ company }),\r\n        });\r\n\r\n        if (!res.ok) throw new Error(\"Failed to fetch company data\");\r\n\r\n        const data = await res.json();\r\n\r\n        // ✅ Log the raw response for debugging\r\n        console.log(\"Fetched Company Data:\", data);\r\n        const companyData = data.company_name_scrape;\r\n        if (!companyData) throw new Error(\"Invalid data format\");\r\n\r\n        // ✅ Set scoring safely\r\n        setScoring({\r\n          credibility_score: Number(companyData.credibility_score) || 0,\r\n          referential_score: Number(companyData.referential_score) || 0,\r\n          compliance_score: Number(companyData.compliance_score) || 0,\r\n          credibility_reasoning: companyData.credibility_reasoning,\r\n          referential_reasoning: companyData.referential_reasoning,\r\n          compliance_reasoning: companyData.compliance_reasoning,\r\n        });\r\n\r\n        // ✅ Log computed scoring for clarity\r\n        console.log(\"Processed Scoring:\", {\r\n          credibility_score: Number(data.credibility_score) || 0,\r\n          referential_score: Number(data.referential_score) || 0,\r\n          compliance_score: Number(data.compliance_score) || 0,\r\n        });\r\n\r\n        // ✅ Set projects\r\n        const projectList = [\r\n          { title: companyData.project_title1, description: companyData.project_description1 },\r\n          { title: companyData.project_title2, description: companyData.project_description2 },\r\n          { title: companyData.project_title3, description: companyData.project_description3 },\r\n        ];\r\n        setProjects(projectList);\r\n\r\n        // ✅ Log processed projects\r\n        console.log(\"Processed Projects:\", projectList);\r\n      } catch (err: any) {\r\n        console.error(\"Fetch Error:\", err);\r\n        setError(err.message || \"Something went wrong\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchCompanyData();\r\n  }, [company, API]);\r\n\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-6 text-center\">\r\n        <p className=\"text-lg font-semibold\">Loading company details...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"p-6 text-center text-red-600\">\r\n        <p>{error}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // ✅ Calculate overall synergy score\r\n  const overallSynergy = scoring\r\n    ? Math.round(\r\n      ((scoring.credibility_score +\r\n        scoring.referential_score +\r\n        scoring.compliance_score) / 3) * 100\r\n    )\r\n    : 0;\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto p-6\">\r\n      <button\r\n        onClick={() => router.back()}\r\n        className=\"flex items-center mb-4 text-blue-600 hover:underline\"\r\n      >\r\n        <FaArrowLeft className=\"mr-2\" /> Back\r\n      </button>\r\n\r\n      <h1 className=\"text-2xl font-bold mb-6\">\r\n        Collaboration Details for {company}\r\n      </h1>\r\n\r\n      {/* Synergy Scoring Section */}\r\n      <section className=\"mb-8\">\r\n        <div className=\"text-center mb-8\">\r\n          <h2 className=\"text-2xl font-bold text-red-600 mb-6\">\r\n            Synergy Score\r\n          </h2>\r\n          <div className=\"flex justify-center mb-8\">\r\n            <CircularProgress score={overallSynergy} />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Score Cards */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n          <ScoreCard\r\n            title=\"Credibility\"\r\n            score={scoring?.credibility_score}\r\n            reasoning={scoring?.credibility_reasoning}\r\n            color=\"bg-red-600\"\r\n          />\r\n          <ScoreCard\r\n            title=\"Referential\"\r\n            score={scoring?.referential_score}\r\n            reasoning={scoring?.referential_reasoning}\r\n            color=\"bg-red-500\"\r\n          />\r\n          <ScoreCard\r\n            title=\"Compliance\"\r\n            score={scoring?.compliance_score}\r\n            reasoning={scoring?.compliance_reasoning}\r\n            color=\"bg-red-700\"\r\n          />\r\n        </div>\r\n      </section>\r\n\r\n      {/* Projects Section */}\r\n      <section>\r\n        <h2 className=\"text-xl font-semibold mb-4\">Recommended Projects</h2>\r\n        <div className=\"grid gap-4\">\r\n          {projects.map((p, idx) => (\r\n            <ProjectCard key={idx} title={p.title} description={p.description} />\r\n          ))}\r\n        </div>\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction CircularProgress({ score }: { score: number }) {\r\n  const radius = 80;\r\n  const circumference = 2 * Math.PI * radius;\r\n  const strokeDasharray = `${(score / 100) * circumference} ${circumference}`;\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <svg width=\"200\" height=\"200\" className=\"transform -rotate-90\">\r\n        {/* Background circle */}\r\n        <circle\r\n          cx=\"100\"\r\n          cy=\"100\"\r\n          r={radius}\r\n          stroke=\"#e5e7eb\"\r\n          strokeWidth=\"20\"\r\n          fill=\"none\"\r\n        />\r\n        {/* Progress circle */}\r\n        <circle\r\n          cx=\"100\"\r\n          cy=\"100\"\r\n          r={radius}\r\n          stroke=\"#dc2626\"\r\n          strokeWidth=\"20\"\r\n          fill=\"none\"\r\n          strokeDasharray={strokeDasharray}\r\n          strokeLinecap=\"round\"\r\n          className=\"transition-all duration-1000 ease-out\"\r\n        />\r\n      </svg>\r\n      <div className=\"absolute inset-0 flex items-center justify-center\">\r\n        <span className=\"text-4xl font-bold text-gray-800\">{score}%</span>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ScoreCard({\r\n  title,\r\n  score,\r\n  reasoning,\r\n  color,\r\n}: {\r\n  title: string;\r\n  score?: number;\r\n  reasoning?: string;\r\n  color: string;\r\n}) {\r\n  const percentage = score !== undefined ? (score * 100).toFixed(0) : \"0\";\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-lg overflow-hidden\">\r\n      <div className=\"text-center py-4 border-b-2 border-gray-200\">\r\n        <h3 className=\"font-bold text-lg text-gray-800\">{title}</h3>\r\n        <p className=\"text-4xl font-bold text-gray-800 mt-2\">{percentage}%</p>\r\n      </div>\r\n\r\n      <div className={`${color} text-white p-4 space-y-4`}>\r\n        {reasoning && (\r\n          <details className=\"mt-4\">\r\n            <summary className=\"font-semibold text-sm cursor-pointer hover:text-gray-200\">\r\n              View Detailed Analysis\r\n            </summary>\r\n            <p className=\"mt-2 text-xs leading-relaxed whitespace-pre-line border-t border-red-400 pt-2\">\r\n              {reasoning}\r\n            </p>\r\n          </details>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ProjectCard({ title, description }: { title: string; description: string }) {\r\n  return (\r\n    <div className=\"bg-white p-4 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-2\">{title}</h3>\r\n      <p className=\"text-gray-700\">{description}</p>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,qBACE,8OAAC,qMAAA,CAAA,WAAQ;QAAC,wBAAU,8OAAC;sBAAI;;;;;;kBACvB,cAAA,8OAAC;;;;;;;;;;AAGP;AAEA,SAAS;IACP,MAAM;IACN,MAAM,eAAe,CAAA,GAAA,kIAAA,CAAA,kBAAe,AAAD;IACnC,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,UAAU,aAAa,GAAG,CAAC;IAEjC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAO3B;IAEV,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAErC,EAAE;IAEJ,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,mBAAmB;YACvB,IAAI,CAAC,SAAS;YAEd,MAAM,QAAQ,eAAe,OAAO,CAAC;YACrC,IAAI,CAAC,OAAO;gBACV,SAAS;gBACT,WAAW;gBACX;YACF;YAEA,IAAI;gBACF,WAAW;gBACX,MAAM,MAAM,MAAM,MAAM,GAAG,IAAI,sBAAsB,CAAC,EAAE;oBACtD,QAAQ;oBACR,SAAS;wBACP,gBAAgB;wBAChB,eAAe,CAAC,OAAO,EAAE,OAAO;oBAClC;oBACA,MAAM,KAAK,SAAS,CAAC;wBAAE;oBAAQ;gBACjC;gBAEA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;gBAE7B,MAAM,OAAO,MAAM,IAAI,IAAI;gBAE3B,uCAAuC;gBACvC,QAAQ,GAAG,CAAC,yBAAyB;gBACrC,MAAM,cAAc,KAAK,mBAAmB;gBAC5C,IAAI,CAAC,aAAa,MAAM,IAAI,MAAM;gBAElC,uBAAuB;gBACvB,WAAW;oBACT,mBAAmB,OAAO,YAAY,iBAAiB,KAAK;oBAC5D,mBAAmB,OAAO,YAAY,iBAAiB,KAAK;oBAC5D,kBAAkB,OAAO,YAAY,gBAAgB,KAAK;oBAC1D,uBAAuB,YAAY,qBAAqB;oBACxD,uBAAuB,YAAY,qBAAqB;oBACxD,sBAAsB,YAAY,oBAAoB;gBACxD;gBAEA,qCAAqC;gBACrC,QAAQ,GAAG,CAAC,sBAAsB;oBAChC,mBAAmB,OAAO,KAAK,iBAAiB,KAAK;oBACrD,mBAAmB,OAAO,KAAK,iBAAiB,KAAK;oBACrD,kBAAkB,OAAO,KAAK,gBAAgB,KAAK;gBACrD;gBAEA,iBAAiB;gBACjB,MAAM,cAAc;oBAClB;wBAAE,OAAO,YAAY,cAAc;wBAAE,aAAa,YAAY,oBAAoB;oBAAC;oBACnF;wBAAE,OAAO,YAAY,cAAc;wBAAE,aAAa,YAAY,oBAAoB;oBAAC;oBACnF;wBAAE,OAAO,YAAY,cAAc;wBAAE,aAAa,YAAY,oBAAoB;oBAAC;iBACpF;gBACD,YAAY;gBAEZ,2BAA2B;gBAC3B,QAAQ,GAAG,CAAC,uBAAuB;YACrC,EAAE,OAAO,KAAU;gBACjB,QAAQ,KAAK,CAAC,gBAAgB;gBAC9B,SAAS,IAAI,OAAO,IAAI;YAC1B,SAAU;gBACR,WAAW;YACb;QACF;QAEA;IACF,GAAG;QAAC;QAAS;KAAI;IAGjB,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAE,WAAU;0BAAwB;;;;;;;;;;;IAG3C;IAEA,IAAI,OAAO;QACT,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;0BAAG;;;;;;;;;;;IAGV;IAEA,oCAAoC;IACpC,MAAM,iBAAiB,UACnB,KAAK,KAAK,CACV,AAAC,CAAC,QAAQ,iBAAiB,GACzB,QAAQ,iBAAiB,GACzB,QAAQ,gBAAgB,IAAI,IAAK,OAEnC;IAEJ,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,SAAS,IAAM,OAAO,IAAI;gBAC1B,WAAU;;kCAEV,8OAAC,8IAAA,CAAA,cAAW;wBAAC,WAAU;;;;;;oBAAS;;;;;;;0BAGlC,8OAAC;gBAAG,WAAU;;oBAA0B;oBACX;;;;;;;0BAI7B,8OAAC;gBAAQ,WAAU;;kCACjB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;0CAAuC;;;;;;0CAGrD,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAiB,OAAO;;;;;;;;;;;;;;;;;kCAK7B,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,OAAM;gCACN,OAAO,SAAS;gCAChB,WAAW,SAAS;gCACpB,OAAM;;;;;;0CAER,8OAAC;gCACC,OAAM;gCACN,OAAO,SAAS;gCAChB,WAAW,SAAS;gCACpB,OAAM;;;;;;0CAER,8OAAC;gCACC,OAAM;gCACN,OAAO,SAAS;gCAChB,WAAW,SAAS;gCACpB,OAAM;;;;;;;;;;;;;;;;;;0BAMZ,8OAAC;;kCACC,8OAAC;wBAAG,WAAU;kCAA6B;;;;;;kCAC3C,8OAAC;wBAAI,WAAU;kCACZ,SAAS,GAAG,CAAC,CAAC,GAAG,oBAChB,8OAAC;gCAAsB,OAAO,EAAE,KAAK;gCAAE,aAAa,EAAE,WAAW;+BAA/C;;;;;;;;;;;;;;;;;;;;;;AAM9B;AAEA,SAAS,iBAAiB,EAAE,KAAK,EAAqB;IACpD,MAAM,SAAS;IACf,MAAM,gBAAgB,IAAI,KAAK,EAAE,GAAG;IACpC,MAAM,kBAAkB,GAAG,AAAC,QAAQ,MAAO,cAAc,CAAC,EAAE,eAAe;IAE3E,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,OAAM;gBAAM,QAAO;gBAAM,WAAU;;kCAEtC,8OAAC;wBACC,IAAG;wBACH,IAAG;wBACH,GAAG;wBACH,QAAO;wBACP,aAAY;wBACZ,MAAK;;;;;;kCAGP,8OAAC;wBACC,IAAG;wBACH,IAAG;wBACH,GAAG;wBACH,QAAO;wBACP,aAAY;wBACZ,MAAK;wBACL,iBAAiB;wBACjB,eAAc;wBACd,WAAU;;;;;;;;;;;;0BAGd,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAK,WAAU;;wBAAoC;wBAAM;;;;;;;;;;;;;;;;;;AAIlE;AAEA,SAAS,UAAU,EACjB,KAAK,EACL,KAAK,EACL,SAAS,EACT,KAAK,EAMN;IACC,MAAM,aAAa,UAAU,YAAY,CAAC,QAAQ,GAAG,EAAE,OAAO,CAAC,KAAK;IAEpE,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAmC;;;;;;kCACjD,8OAAC;wBAAE,WAAU;;4BAAyC;4BAAW;;;;;;;;;;;;;0BAGnE,8OAAC;gBAAI,WAAW,GAAG,MAAM,yBAAyB,CAAC;0BAChD,2BACC,8OAAC;oBAAQ,WAAU;;sCACjB,8OAAC;4BAAQ,WAAU;sCAA2D;;;;;;sCAG9E,8OAAC;4BAAE,WAAU;sCACV;;;;;;;;;;;;;;;;;;;;;;;AAOf;AAEA,SAAS,YAAY,EAAE,KAAK,EAAE,WAAW,EAA0C;IACjF,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAA8B;;;;;;0BAC5C,8OAAC;gBAAE,WAAU;0BAAiB;;;;;;;;;;;;AAGpC","debugId":null}}]
}